# Load libraries
library(tidyverse)
library(GGally)
set.seed(42)  # reproducibility
##length of dataframe
n <- 120
##puesdo dataset
dataset <- data.frame(
Plot = sample(paste0("Plot_", 1:10), n, replace = TRUE),
Species = sample(c("Species_A", "Species_B", "Species_C", "Species_D"), n, replace = TRUE),
LT = round(rnorm(n, mean = 0.35, sd = 0.05), 3),         # mm
Water_Potential = round(rnorm(n, mean = -1.2, sd = 0.3), 2),  # MPa
LWC = round(rnorm(n, mean = 2.5, sd = 0.4), 2),          # g
DBH = round(rnorm(n, mean = 0.25, sd = 0.07), 2),        # m
Tree_Height = round(rnorm(n, mean = 12, sd = 3), 1),     # m
LMA = round(rnorm(n, mean = 0.012, sd = 0.003), 4),      # m2/g
Stress_Level = sample(1:3, n, replace = TRUE, prob = c(0.4, 0.35, 0.25)),  # Ordinal
VPD = round(rnorm(n, mean = 1.8, sd = 0.5), 2),          # kPa
Precip = round(rnorm(n, mean = 900, sd = 150), 0),       # mm
Leaf_Spectral = sample(1000:5000, n, replace = TRUE)     # discrete reflectance values
)
head(dataset)
##get the summary of the dataset
summary(dataset)
##get the summary of the dataset
summary(dataset)
table(dataset$Species)
table(dataset$Stress_Level)
var(dataset$DBH)
quantile(dataset$Precip, probs = c(0.25,0.5,0.75))
##get the summary of the dataset
summary(dataset)
##check for outliers
boxplot(dataset$Water_Potential,
#main = "Boxplot of Sparrow Wing Length",
ylab = "water potential (mpa)",
xlab = "",
col = "lightblue",
border = "darkblue")
#Do we have homogeneity of variance?
boxplot(Water_Potential ~ Plot:Species, data = dataset)
#Are the data normally distributed?
hist(dataset$Water_Potential)
#Are there lots of zeros in the data?
hist(dataset$Water_Potential, main = "Zero-inflated Poisson Distribution", xlab = "Counts")
#Collinearity X?
plot(dataset)
#Relationships Y & X
plot(data=dataset, dataset$Water_Potential~dataset$LT)
M.loess <- lm(dataset$Water_Potential~dataset$LT)
Fit <- fitted(M.loess)
head(Fit)
#Interactions
coplot(dataset$Water_Potential~dataset$LT | dataset$Species,
panel = function(x, y, ...) {
tmp <- lm(y ~ x, na.action = na.omit)
abline(tmp)
points(x, y) })
#Are observations of the response variable independent?
#Check for autocorrelation in residuals if data are time-ordered
acf(dataset$Water_Potential, main = "ACF of Model Residuals")
##check for outliers
boxplot(dataset$Water_Potential,
#main = "Boxplot of Sparrow Wing Length",
ylab = "water potential (mpa)",
xlab = "",
col = "lightblue",
border = "darkblue")
##check for outliers
boxplot(dataset$Water_Potential,
main = "outlier detection",
ylab = "water potential (mpa)",
xlab = "",
col = "lightblue",
border = "darkblue")
#Collinearity X?
plot(dataset, main = "collinearilty check")
# Missing data check
colSums(is.na(dataset))
# Load libraries
library(tidyverse)
library(GGally)
set.seed(42)  # reproducibility
##length of dataframe
n <- 120
##puesdo dataset
dataset <- data.frame(
Plot = sample(paste0("Plot_", 1:10), n, replace = TRUE),
Species = sample(c("Species_A", "Species_B", "Species_C", "Species_D"), n, replace = TRUE),
LT = round(rnorm(n, mean = 0.35, sd = 0.05), 3),         # mm
Water_Potential = round(rnorm(n, mean = -1.2, sd = 0.3), 2),  # MPa
LWC = round(rnorm(n, mean = 2.5, sd = 0.4), 2),          # g
DBH = round(rnorm(n, mean = 0.25, sd = 0.07), 2),        # m
Tree_Height = round(rnorm(n, mean = 12, sd = 3), 1),     # m
LMA = round(rnorm(n, mean = 0.012, sd = 0.003), 4),      # m2/g
Stress_Level = sample(1:3, n, replace = TRUE, prob = c(0.4, 0.35, 0.25)),  # Ordinal
VPD = round(rnorm(n, mean = 1.8, sd = 0.5), 2),          # kPa
Precip = round(rnorm(n, mean = 900, sd = 150), 0),       # mm
Leaf_Spectral = sample(1000:5000, n, replace = TRUE)     # discrete reflectance values
)
head(dataset)
##get the summary of the dataset
summary(dataset)
table(dataset$Species)
table(dataset$Stress_Level)
var(dataset$DBH)
quantile(dataset$Precip, probs = c(0.25,0.5,0.75))
##check for outliers
boxplot(dataset$Water_Potential,
main = "outlier detection",
ylab = "water potential (mpa)",
xlab = "",
col = "lightblue",
border = "darkblue")
#Are the data normally distributed?
hist(dataset$Water_Potential)
View(dataset)
#scatter plot of response variable (water potential) and one of the explanatory variables (LT)
plot(x = dataset$LT, y = dataset$Water_Potential, main = "scatter plot")
##get the summary of the dataset
summary(dataset)
table(dataset$Species)
table(dataset$Plot)
var(dataset$DBH)
sapply(dataset, var, na.rm = TRUE)
#get the variance of all my variables
sapply(dataset, var, na.rm = TRUE)
#95% quantitle for all numeric variables
sapply(df[sapply(df, is.numeric)], quantile, probs = c(0.95), na.rm = TRUE)
#95% quantitle for all numeric variables
sapply(dataset[sapply(dataset, is.numeric)], quantile, probs = c(0.95), na.rm = TRUE)
#95% quantitle for all numeric variables
sapply(dataset[sapply(dataset, is.numeric)], quantile, probs = c(0.95), na.rm = TRUE)
# Histograms
ggplot(dataset, aes(x = DBH)) + geom_histogram(binwidth = 0.05, fill = "skyblue")
# Boxplots
ggplot(dataset, aes(x = Species, y = LT, fill = Species)) + geom_boxplot()
# Scatterplot matrix for collinearity
ggpairs(dataset[,c("DBH","Tree_Height","LWC","VPD","Precip")])
# Outlier check
boxplot(dataset$Precip, main="Precipitation Outliers")
# Relationship example
ggplot(dataset, aes(x = Precip, y = Stress_Level, color = Species)) +
geom_jitter(width=0.2, height=0.1) + theme_minimal()
# Scatterplot matrix for collinearity
ggpairs(dataset[,c("DBH","Tree_Height","LWC","VPD","Precip")])
##plot zero data
# Example: simulate zero-inflated count data
hist(dataset$Water_Potential, main = "Zero-inflated Distribution for our response variable", xlab = "Counts")
# Load libraries
library(tidyverse)
library(GGally)
# Load libraries
library(tidyverse)
library(GGally)
# Load libraries
library(tidyverse)
library(GGally)
set.seed(42)  # reproducibility
##length of dataframe
n <- 120
##puesdo dataset
dataset <- data.frame(
Plot = sample(paste0("Plot_", 1:10), n, replace = TRUE),
Species = sample(c("Species_A", "Species_B", "Species_C", "Species_D"), n, replace = TRUE),
LT = round(rnorm(n, mean = 0.35, sd = 0.05), 3),         # mm
Water_Potential = round(rnorm(n, mean = -1.2, sd = 0.3), 2),  # MPa
LWC = round(rnorm(n, mean = 2.5, sd = 0.4), 2),          # g
DBH = round(rnorm(n, mean = 0.25, sd = 0.07), 2),        # m
Tree_Height = round(rnorm(n, mean = 12, sd = 3), 1),     # m
LMA = round(rnorm(n, mean = 0.012, sd = 0.003), 4),      # m2/g
Stress_Level = sample(1:3, n, replace = TRUE, prob = c(0.4, 0.35, 0.25)),  # Ordinal
VPD = round(rnorm(n, mean = 1.8, sd = 0.5), 2),          # kPa
Precip = round(rnorm(n, mean = 900, sd = 150), 0),       # mm
Leaf_Spectral = sample(1000:5000, n, replace = TRUE)     # discrete reflectance values
)
head(dataset)
##get the summary of the dataset
summary(dataset)
#distribution of nominal variables
table(dataset$Species)
table(dataset$Plot)
#get the variance of all my variables
sapply(dataset, var, na.rm = TRUE)
#95% quantitle for all numeric variables
sapply(dataset[sapply(dataset, is.numeric)], quantile, probs = c(0.95), na.rm = TRUE)
# The Data Exploration Using Zuur’s 8-Step Protocol
##check for outliers
boxplot(dataset$Water_Potential,
main = "outlier detection",
ylab = "water potential (mpa)",
xlab = "",
col = "lightblue",
border = "darkblue")
#Do we have homogeneity of variance?
boxplot(Water_Potential ~ Plot:Species, data = dataset)
#Are the data normally distributed?
hist(dataset$Water_Potential)
#Are there lots of zeros in the data?
hist(dataset$Water_Potential, main = "Zero-inflated Poisson Distribution", xlab = "Counts")
#Collinearity X?
plot(dataset, main = "collinearilty check")
#Relationships Y & X
plot(data=dataset, dataset$Water_Potential~dataset$LT)
M.loess <- lm(dataset$Water_Potential~dataset$LT)
Fit <- fitted(M.loess)
head(Fit)
#Interactions
coplot(dataset$Water_Potential~dataset$LT | dataset$Species,
panel = function(x, y, ...) {
tmp <- lm(y ~ x, na.action = na.omit)
abline(tmp)
points(x, y) })
#Are observations of the response variable independent?
#Check for autocorrelation in residuals if data are time-ordered
acf(dataset$Water_Potential, main = "ACF of Model Residuals")
# Missing data check
colSums(is.na(dataset))
##plot zero data
# Example: simulate zero-inflated count data
hist(dataset$Water_Potential, main = "Zero-inflated Distribution for our response variable", xlab = "Counts")
#scatter plot of response variable (water potential) and one of the explanatory variables (LT)
plot(x = dataset$LT, y = dataset$Water_Potential, main = "scatter plot")
# Histograms
ggplot(dataset, aes(x = DBH)) + geom_histogram(binwidth = 0.05, fill = "skyblue")
# Boxplots
ggplot(dataset, aes(x = Species, y = LT, fill = Species)) + geom_boxplot()
# Scatterplot matrix for collinearity
ggpairs(dataset[,c("DBH","Tree_Height","LWC","VPD","Precip")])
# The Data Exploration Using Zuur’s 8-Step Protocol
##check for outliers
boxplot(dataset$Water_Potential,
main = "outlier detection",
ylab = "water potential (mpa)",
xlab = "",
col = "lightblue",
border = "darkblue")
#Do we have homogeneity of variance?
boxplot(Water_Potential ~ Plot:Species, data = dataset)
#Are the data normally distributed?
hist(dataset$Water_Potential)
#Are there lots of zeros in the data?
hist(dataset$Water_Potential, main = "Zero-inflated Poisson Distribution", xlab = "Counts")
#Collinearity X?
plot(dataset, main = "collinearilty check")
#Relationships Y & X
plot(data=dataset, dataset$Water_Potential~dataset$LT)
M.loess <- lm(dataset$Water_Potential~dataset$LT)
Fit <- fitted(M.loess)
head(Fit)
#Interactions
coplot(dataset$Water_Potential~dataset$LT | dataset$Species,
panel = function(x, y, ...) {
tmp <- lm(y ~ x, na.action = na.omit)
abline(tmp)
points(x, y) })
#Are observations of the response variable independent?
#Check for autocorrelation in residuals if data are time-ordered
acf(dataset$Water_Potential, main = "ACF of Model Residuals")
# Missing data check
colSums(is.na(dataset))
##plot zero data
# Example: simulate zero-inflated count data
hist(dataset$Water_Potential, main = "Zero-inflated Distribution for our response variable", xlab = "Counts")
#scatter plot of response variable (water potential) and one of the explanatory variables (LT)
plot(x = dataset$LT, y = dataset$Water_Potential, main = "scatter plot")
# Histograms
ggplot(dataset, aes(x = DBH)) + geom_histogram(binwidth = 0.05, fill = "skyblue")
# Boxplots
ggplot(dataset, aes(x = Species, y = LT, fill = Species)) + geom_boxplot()
# Outlier check
boxplot(dataset$Precip, main="Precipitation Outliers")
# Relationship example
ggplot(dataset, aes(x = Precip, y = Stress_Level, color = Species)) +
geom_jitter(width=0.2, height=0.1) + theme_minimal()
