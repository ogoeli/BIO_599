df1 <- read.csv("SUMMER_2024.csv")
df2 <- read.csv("Fielddata_analysis_01Sep24.csv")
df2_long <- df2 %>%
# gather the paired columns into long form
pivot_longer(
cols = c(H_l1, WP1, FW1, DW1, H_l2, WP2, FW2, DW2),
names_to = c(".value", "Level"),
names_pattern = "(.*)([12])"
) %>%
mutate(
Level = ifelse(Level == "1", "L1", "L2"),
# match df1 column names
Tree_number = Tree_name,
Plot = sub("^(.*)-T\\d+$", "\\1", Tree_name),  # pull plot ID from tree name
Year = 2024  # hardcode since df1 shows only 2024
) %>%
select(
Plot,
Tree_number,
DBH,
Height,
X = fid,   # if df1 uses spatial coords, swap real X/Y columns here
Y = id,
Species,
SP_CODE = Species, # df1 uses a short code, you may need to join later
Stress = Stress_Ind,
Rep = id,          # placeholder, adjust if df1 has actual Rep column
Dendro_number = id, # placeholder again
Level,
WP,
FW,
DW,
LWC = RWC1,        # df2 has RWC1/RWC2 instead of LWC; pick the right one
Time = T_coll,
Year
)
library(tidyverse)
df1 <- read.csv("SUMMER_2024.csv")
df2 <- read.csv("Fielddata_analysis_01Sep24.csv")
df2_long <- df2 %>%
# gather the paired columns into long form
pivot_longer(
cols = c(H_l1, WP1, FW1, DW1, H_l2, WP2, FW2, DW2),
names_to = c(".value", "Level"),
names_pattern = "(.*)([12])"
) %>%
mutate(
Level = ifelse(Level == "1", "L1", "L2"),
# match df1 column names
Tree_number = Tree_name,
Plot = sub("^(.*)-T\\d+$", "\\1", Tree_name),  # pull plot ID from tree name
Year = 2024  # hardcode since df1 shows only 2024
) %>%
select(
Plot,
Tree_number,
DBH,
Height,
X = fid,   # if df1 uses spatial coords, swap real X/Y columns here
Y = id,
Species,
SP_CODE = Species, # df1 uses a short code, you may need to join later
Stress = Stress_Ind,
Rep = id,          # placeholder, adjust if df1 has actual Rep column
Dendro_number = id, # placeholder again
Level,
WP,
FW,
DW,
LWC = RWC1,        # df2 has RWC1/RWC2 instead of LWC; pick the right one
Time = T_coll,
Year
)
View(df2_long)
# Export to CSV
write.csv(df2_long, "df2_reshaped.csv", row.names = FALSE)
# --- Step 1: reshape df2 to long like df1 ---
df2_long <- df2 %>%
pivot_longer(
cols = c(H_l1, WP1, FW1, DW1, H_l2, WP2, FW2, DW2),
names_to = c(".value", "Level"),
names_pattern = "(.*)([12])"
) %>%
mutate(
Level = ifelse(Level == "1", "L1", "L2"),
Tree_number = Tree_name,
Plot = sub("^(.*)-T\\d+$", "\\1", Tree_name),
Year = 2024
)
# --- Step 2: join SP_CODE from df1 using Tree_number/Tree_name ---
df2_long <- df2_long %>%
left_join(
df1 %>% select(Tree_number, SP_CODE),
by = "Tree_number"
)
View(df1)
# --- Step 2: join SP_CODE from df1 using Tree_number/Tree_name ---
df2_long <- df2_long %>%
left_join(
df1 %>% select(Tree_name, SP_CODE),
by = "Tree_name"
)
# --- Step 3: reorder/select columns to match df1 format ---
df2_long <- df2_long %>%
select(
Plot,
Tree_number,
DBH,
Height,
X = fid,
Y = id,
Species,
SP_CODE,
Stress = Stress_Ind,
Rep = id,           # adjust if real Rep column exists
Dendro_number = id, # adjust if real dendro number exists
Level,
WP,
FW,
DW,
LWC = RWC1,         # placeholder; map RWC1/L1 and RWC2/L2 if needed
Time = T_coll,
Year
)
# --- Step 4: export ---
write.csv(df2_long, "df2_reshaped_with_spcode.csv", row.names = FALSE)
df2
colnames(df2)
library(tidyverse)
df1 <- read.csv("SUMMER_2024.csv")
df2 <- read.csv("Fielddata_analysis_01Sep24.csv")
colnames(df2)
df2_long <- df2 %>%
# gather the paired columns into long form
pivot_longer(
cols = c(H_l1, WP1, FW1, DW1, TW1, H_l2, WP2, FW2, DW2, TW2),
names_to = c(".value", "Level"),
names_pattern = "(.*)([12])"
) %>%
mutate(
Level = ifelse(Level == "1", "L1", "L2"),
# match df1 column names
Tree_number = Tree_name,
Plot = sub("^(.*)-T\\d+$", "\\1", Tree_name),  # pull plot ID from tree name
Year = 2024  # hardcode since df1 shows only 2024
) %>%
select(
Plot,
Tree_number,
DBH,
Height,
X = fid,   # if df1 uses spatial coords, swap real X/Y columns here
Y = id,
Species,
SP_CODE = Species, # df1 uses a short code, you may need to join later
Stress = Stress_Ind,
Rep = id,          # placeholder, adjust if df1 has actual Rep column
Dendro_number = id, # placeholder again
Level,
WP,
FW,
DW,
LWC = RWC1,        # df2 has RWC1/RWC2 instead of LWC; pick the right one
Time = T_coll,
Year
TW
df2_long <- df2 %>%
# gather the paired columns into long form
pivot_longer(
cols = c(H_l1, WP1, FW1, DW1, TW1, H_l2, WP2, FW2, DW2, TW2),
names_to = c(".value", "Level"),
names_pattern = "(.*)([12])"
) %>%
mutate(
Level = ifelse(Level == "1", "L1", "L2"),
# match df1 column names
Tree_number = Tree_name,
Plot = sub("^(.*)-T\\d+$", "\\1", Tree_name),  # pull plot ID from tree name
Year = 2024  # hardcode since df1 shows only 2024
) %>%
select(
Plot,
Tree_number,
DBH,
Height,
X = fid,   # if df1 uses spatial coords, swap real X/Y columns here
Y = id,
Species,
SP_CODE = Species, # df1 uses a short code, you may need to join later
Stress = Stress_Ind,
Rep = id,          # placeholder, adjust if df1 has actual Rep column
Dendro_number = id, # placeholder again
Level,
WP,
FW,
DW,
LWC = RWC1,        # df2 has RWC1/RWC2 instead of LWC; pick the right one
Time = T_coll,
Year,
TW
)
# Export to CSV
write.csv(df2_long, "df2_reshaped.csv", row.names = FALSE)
