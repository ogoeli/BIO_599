"0","    data_3 <- read.csv(""Biodiversity.csv"")"
"0","    str(data_3)"
"1","'data.frame':	"
"1",""
"1","108"
"1",""
"1"," obs. of  "
"1",""
"1","7"
"1",""
"1"," variable"
"1",""
"1","s"
"1",""
"1",":"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","MU           "
"1",""
"1",":"
"1"," int  "
"1",""
"1","1 1 1 2 2 2 3 3 3 4"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Mesocosm     "
"1",""
"1",":"
"1"," int  "
"1",""
"1","1 1 1 2 2 2 3 3 3 4"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Abundance    "
"1",""
"1",":"
"1"," int  "
"1",""
"1","0 0 0 4 4 4 8 8 8 8"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Biomass      "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0 0 0 0.5 0.5 0.5 1 1 1 1"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Treatment    "
"1",""
"1",":"
"1"," chr  "
"1",""
"1","""NoAlgae"" ""NoAlgae"" ""NoAlgae"" ""NoAlgae"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Nutrient     "
"1",""
"1",":"
"1"," chr  "
"1",""
"1","""NO3"" ""NO3"" ""NO3"" ""NO3"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Concentration"
"1",""
"1",":"
"1"," num  "
"1",""
"1","2.49 1.18 3.83 3.04 2.19"
"1",""
"1"," ..."
"1",""
"1","
"
"0","    # ensure factors"
"0","    data_3$Treatment <- factor(data_3$Treatment)"
"0","    data_3$Nutrient  <- factor(data_3$Nutrient)"
"0","    # if Abundance is categorical:"
"0","    data_3$Abundance_f <- data_3$Abundance"
"0",""
"0",""
"0","    # simple GLS full model (no random intercepts)"
"0","    g_full <- gls(Concentration ~ Treatment * Nutrient * Abundance_f,"
"0","                  data = data_3,"
"0","                  method = ""ML"")   # ML for comparing fixed structures"
"0",""
"0","    # test 3-way"
"0","    g_no3way <- update(g_full, . ~ . - Treatment:Nutrient:Abundance_f)"
"0","    anova(g_full, g_no3way)"
