<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ogonna Eli">

<title>Week 11</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="WEEK_11_files/libs/clipboard/clipboard.min.js"></script>
<script src="WEEK_11_files/libs/quarto-html/quarto.js"></script>
<script src="WEEK_11_files/libs/quarto-html/popper.min.js"></script>
<script src="WEEK_11_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="WEEK_11_files/libs/quarto-html/anchor.min.js"></script>
<link href="WEEK_11_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="WEEK_11_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="WEEK_11_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="WEEK_11_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="WEEK_11_files/libs/bootstrap/bootstrap-8a79a254b8e706d3c925cde0a310d4f0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 11</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ogonna Eli </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.4.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'purrr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   4.0.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.1.0     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'glmmTMB' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'DHARMa' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is DHARMa 0.4.7. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'sjPlot' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'sjPlot'

The following object is masked from 'package:ggplot2':

    set_theme</code></pre>
</div>
</div>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises"><strong>Exercises</strong></h2>
<section id="fishing" class="level3">
<h3 class="anchored" data-anchor-id="fishing"><strong>1. Fishing</strong></h3>
<p>These data (fish.csv) come from a survey of 250 groups that visited a state park. The dataset includes: - <code>count</code>: number of fish caught by the group - <code>child</code>: number of children in the group - <code>persons</code>: total number of people in the group - <code>camper</code>: 1 if the group brought a camper, 0 otherwise</p>
<ol type="1">
<li><p>Visualize the distribution of fish counts. What does the distribution look like?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"fish.csv"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      X count livebait camper persons child
1     1     0        0      0       1     0
2     2     0        1      1       1     0
3     3     0        1      0       1     0
4     4     0        1      1       2     1
5     5     1        1      0       1     0
6     6     0        1      1       4     2
7     7     0        1      0       3     1
8     8     0        1      0       4     3
9     9     0        0      1       3     2
10   10     1        1      1       1     0
11   11     0        1      0       4     1
12   12     0        1      1       3     2
13   13     1        0      0       3     0
14   14     2        1      0       3     0
15   15     0        1      1       1     0
16   16     1        1      1       1     0
17   17     0        1      0       4     1
18   18     0        1      1       3     2
19   19     1        1      1       2     1
20   20     0        1      0       3     1
21   21     1        1      0       4     1
22   22     5        1      1       4     0
23   23     0        1      1       2     1
24   24     3        1      1       2     0
25   25    30        1      1       3     0
26   26     0        1      1       2     0
27   27    13        1      1       4     0
28   28     0        1      0       2     1
29   29     0        1      0       1     0
30   30     0        1      0       4     3
31   31     0        1      0       1     0
32   32     0        1      1       3     1
33   33    11        1      1       4     0
34   34     5        1      1       4     1
35   35     0        1      1       1     0
36   36     1        0      0       2     0
37   37     1        1      1       2     1
38   38     7        1      1       4     1
39   39     0        1      1       3     1
40   40    14        1      1       4     1
41   41     0        1      1       1     0
42   42    32        1      1       4     0
43   43     0        0      0       3     2
44   44     1        0      1       4     0
45   45     0        1      0       4     2
46   46     0        1      1       1     0
47   47     0        1      1       2     1
48   48     1        1      0       1     0
49   49     5        1      1       2     1
50   50     0        1      0       2     1
51   51     1        1      1       2     1
52   52     0        1      1       2     1
53   53    22        1      1       4     0
54   54     0        0      0       2     0
55   55    15        1      1       3     0
56   56     0        0      1       1     0
57   57     0        1      1       1     0
58   58     0        1      1       1     0
59   59     5        1      1       4     1
60   60     4        1      1       1     0
61   61     2        1      0       2     0
62   62     0        1      1       2     1
63   63     2        1      0       2     1
64   64    32        1      1       4     0
65   65     0        1      0       4     3
66   66     0        1      1       1     0
67   67     1        1      0       1     0
68   68     0        1      0       3     2
69   69     0        1      1       1     0
70   70     0        1      1       2     1
71   71     7        1      1       3     0
72   72     0        1      0       4     3
73   73     0        0      0       4     2
74   74     0        1      1       3     2
75   75     0        0      1       1     0
76   76     0        1      0       2     0
77   77     0        1      0       3     2
78   78     0        1      1       1     0
79   79     0        1      0       2     1
80   80     2        1      0       4     0
81   81     3        1      1       4     1
82   82     1        1      0       2     1
83   83     5        1      1       3     0
84   84     0        1      0       1     0
85   85     2        1      1       1     0
86   86     1        0      0       3     1
87   87     0        0      0       4     1
88   88     1        1      1       1     0
89   89   149        1      1       4     0
90   90     0        1      1       3     2
91   91     1        1      1       3     1
92   92     0        1      0       2     0
93   93     0        1      1       3     0
94   94     1        1      0       2     1
95   95     0        1      0       4     2
96   96     0        1      1       3     1
97   97     0        1      0       4     2
98   98     2        0      0       4     0
99   99     2        1      1       2     0
100 100    29        1      0       4     0
101 101     3        1      1       1     0
102 102     0        0      1       2     0
103 103     0        1      0       4     2
104 104     5        0      0       3     0
105 105     0        1      1       2     0
106 106     0        1      0       4     1
107 107     0        1      1       1     0
108 108     0        1      0       3     1
109 109     0        1      1       4     1
110 110     1        1      1       4     1
111 111     7        1      1       1     0
112 112     1        1      1       2     0
113 113     0        1      0       1     0
114 114     2        0      0       4     1
115 115     0        1      0       3     2
116 116     2        1      0       2     0
117 117     0        1      0       2     1
118 118     0        1      0       4     1
119 119     0        0      1       3     1
120 120     1        1      1       3     2
121 121     0        1      0       2     1
122 122     0        1      0       1     0
123 123     0        0      1       4     3
124 124     0        1      0       1     0
125 125     0        0      1       4     3
126 126     3        1      0       4     1
127 127     4        1      1       1     0
128 128     3        1      1       3     0
129 129     3        1      0       2     0
130 130     8        1      1       4     0
131 131     2        0      1       3     0
132 132     1        1      1       1     0
133 133     6        1      0       4     0
134 134     0        1      1       4     2
135 135     0        1      1       2     1
136 136     5        1      0       4     0
137 137     3        1      1       4     1
138 138    31        1      0       3     1
139 139     0        1      1       2     1
140 140     2        1      0       2     0
141 141     0        1      1       4     3
142 142     0        1      1       2     1
143 143     0        0      0       3     0
144 144     0        1      1       3     1
145 145     0        1      0       1     0
146 146     0        1      0       2     0
147 147     6        1      1       4     0
148 148     9        1      0       3     0
149 149     0        0      1       3     2
150 150     0        0      1       2     1
151 151     0        1      1       1     0
152 152     0        1      1       2     1
153 153     0        1      0       1     0
154 154     2        1      0       2     0
155 155    15        1      0       3     0
156 156     1        1      1       1     0
157 157     2        1      1       2     0
158 158     3        1      1       3     1
159 159     0        1      1       1     0
160 160    65        1      1       4     0
161 161     5        1      1       3     0
162 162     0        1      0       1     0
163 163     0        1      1       3     2
164 164     0        1      0       4     1
165 165     0        1      0       4     2
166 166     1        1      0       1     0
167 167     8        1      1       4     1
168 168     0        1      1       3     0
169 169     0        1      1       3     2
170 170     0        1      1       4     3
171 171     2        1      1       3     0
172 172     4        1      1       2     1
173 173     5        1      0       4     0
174 174     9        1      0       2     0
175 175     0        1      0       4     2
176 176     0        1      0       2     0
177 177     0        1      1       2     0
178 178     0        1      0       1     0
179 179    21        1      1       2     0
180 180     0        1      0       1     0
181 181     6        1      1       3     0
182 182     0        1      0       2     1
183 183     0        0      1       2     0
184 184     0        1      1       2     1
185 185     0        1      0       3     1
186 186    16        1      1       4     1
187 187     0        0      0       3     2
188 188     0        1      1       3     2
189 189     4        1      1       4     0
190 190     2        1      1       2     1
191 191    10        1      1       3     0
192 192     0        0      1       1     0
193 193     0        1      1       1     0
194 194     0        0      0       1     0
195 195     2        0      1       2     0
196 196     1        1      1       2     0
197 197     3        1      0       1     0
198 198     0        1      1       3     1
199 199     0        1      1       4     2
200 200    21        1      1       2     0
201 201     0        1      0       2     1
202 202     0        1      0       2     0
203 203     2        0      1       1     0
204 204     0        0      1       2     1
205 205     3        1      1       4     1
206 206     0        1      1       3     1
207 207    38        1      1       4     0
208 208     0        1      1       4     3
209 209     0        1      1       1     0
210 210     0        1      0       1     0
211 211     1        1      1       1     0
212 212     3        1      0       1     0
213 213     0        1      1       1     0
214 214     1        1      0       2     0
215 215     0        1      0       4     2
216 216     0        0      0       2     1
217 217     0        1      0       4     2
218 218     0        1      0       3     1
219 219     5        1      1       4     2
220 220     0        1      0       4     2
221 221     0        0      0       4     1
222 222     2        1      0       3     0
223 223     0        1      1       2     1
224 224     0        1      1       1     0
225 225     0        1      0       2     1
226 226     1        1      1       2     0
227 227     4        1      1       3     1
228 228     0        1      0       1     0
229 229     0        1      1       3     2
230 230     2        1      1       2     1
231 231     3        1      1       1     0
232 232     0        1      0       4     2
233 233     0        1      0       3     1
234 234     0        1      0       2     0
235 235     0        0      0       2     0
236 236     1        1      1       1     0
237 237     2        1      1       2     0
238 238     0        1      1       1     0
239 239     6        1      1       3     0
240 240     4        1      1       2     0
241 241     1        1      1       2     0
242 242     1        1      1       4     2
243 243     0        0      0       2     0
244 244     1        1      1       3     1
245 245     0        1      0       3     0
246 246     0        1      1       2     0
247 247     0        1      1       4     3
248 248     0        1      1       2     1
249 249     0        1      1       3     2
250 250     0        1      1       2     1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data<span class="sc">$</span>count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="WEEK_11_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Fit a Poisson and Negative Binomial model without zero-inflation to test how count is impacted by child, persons, and camper. Compare the models using AIC.</p>
<ul>
<li>based on the AIC, the Negative Binomial model is a better performing model with lower AIC than a poisson model</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>nb_tmb <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(count <span class="sc">~</span> child <span class="sc">+</span> persons <span class="sc">+</span> camper, <span class="at">data =</span> data, <span class="at">family =</span> nbinom2)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nb_tmb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          count ~ child + persons + camper
Data: data

      AIC       BIC    logLik -2*log(L)  df.resid 
    820.4     838.1    -405.2     810.4       245 


Dispersion parameter for nbinom2 family (): 0.464 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -1.6250     0.3294  -4.933 8.09e-07 ***
child        -1.7805     0.1920  -9.272  &lt; 2e-16 ***
persons       1.0608     0.1175   9.030  &lt; 2e-16 ***
camper        0.6211     0.2358   2.634  0.00844 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>possion_tmb <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(count <span class="sc">~</span> child <span class="sc">+</span> persons <span class="sc">+</span> camper, <span class="at">data =</span> data, <span class="at">family =</span> poisson)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(possion_tmb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: poisson  ( log )
Formula:          count ~ child + persons + camper
Data: data

      AIC       BIC    logLik -2*log(L)  df.resid 
   1682.1    1696.2    -837.1    1674.1       246 


Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.98183    0.15226  -13.02   &lt;2e-16 ***
child       -1.68995    0.08099  -20.87   &lt;2e-16 ***
persons      1.09126    0.03926   27.80   &lt;2e-16 ***
camper       0.93093    0.08909   10.45   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(nb_tmb, possion_tmb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            df      AIC
nb_tmb       5  820.444
possion_tmb  4 1682.145</code></pre>
</div>
</div></li>
<li><p>Fit a zero-inflated Poisson model with <code>child</code> as the predictor of zero inflation. Interpret the zero-inflation part.</p>
<ul>
<li>The&nbsp;<code>ziformula</code>&nbsp;uses a logistic regression model (binomial dist) to estimate the probability that an observation is from the&nbsp;<strong>zero-inflation process</strong>, which means it predicts whether an observation is an excess zero (i.e., zero from the zero-inflation process) or comes from the regular count-generating process. Setting it to&nbsp;<code>~1</code>&nbsp;assumes the zero-inflation is contant for all observations.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Zip1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(count <span class="sc">~</span> child <span class="sc">+</span> persons <span class="sc">+</span> camper, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">ziformula =</span> <span class="sc">~</span> child,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> data, <span class="at">family =</span> poisson)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Zip1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: poisson  ( log )
Formula:          count ~ child + persons + camper
Zero inflation:         ~child
Data: data

      AIC       BIC    logLik -2*log(L)  df.resid 
   1544.1    1565.2    -766.0    1532.1       244 


Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.05721    0.18123  -5.834 5.42e-09 ***
child       -1.16755    0.09471 -12.327  &lt; 2e-16 ***
persons      0.88856    0.04663  19.056  &lt; 2e-16 ***
camper       0.77091    0.09384   8.215  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Zero-inflation model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -0.9150     0.2503  -3.655 0.000257 ***
child         1.1857     0.2654   4.468 7.89e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div></li>
<li><p>Fit a zero-inflated Negative Binomial model with <code>child</code> in the zero-inflation part. Is the fit improved?</p>
<ul>
<li>the fit did improve when its a negative binomial model</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>Zinb1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(count <span class="sc">~</span> child <span class="sc">+</span> persons <span class="sc">+</span> camper, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">ziformula =</span> <span class="sc">~</span> child,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> data, <span class="at">family =</span> nbinom2)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Zinb1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          count ~ child + persons + camper
Zero inflation:         ~child
Data: data

      AIC       BIC    logLik -2*log(L)  df.resid 
    813.8     838.5    -399.9     799.8       243 


Dispersion parameter for nbinom2 family (): 0.559 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -1.6600     0.3197  -5.192 2.08e-07 ***
child        -1.2056     0.2715  -4.441 8.95e-06 ***
persons       1.0516     0.1110   9.477  &lt; 2e-16 ***
camper        0.5834     0.2379   2.452   0.0142 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Zero-inflation model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -4.4302     1.5159  -2.923 0.003472 ** 
child         2.9263     0.8478   3.452 0.000557 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(Zip1, Zinb1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      df       AIC
Zip1   6 1544.0557
Zinb1  7  813.8197</code></pre>
</div>
</div></li>
<li><p>Compare AIC for the Poisson, Negative Binomial, and both zero-inflated models. Which model is best?</p>
<ul>
<li>the zero inflated negative binomial model is the best model with lower AIC score</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(Zip1, Zinb1, nb_tmb, possion_tmb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            df       AIC
Zip1         6 1544.0557
Zinb1        7  813.8197
nb_tmb       5  820.4440
possion_tmb  4 1682.1450</code></pre>
</div>
</div></li>
<li><p>For the best model, interpret the coefficients. What variables increase or decrease the number of fish caught?</p>
<ul>
<li><strong>Zero-inflation model:</strong><br>

<ul>
<li>The&nbsp;<strong>probability of false zeros</strong>&nbsp;decreased with increasing child — more child in the group will increase the fish count false zero.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Zinb1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          count ~ child + persons + camper
Zero inflation:         ~child
Data: data

      AIC       BIC    logLik -2*log(L)  df.resid 
    813.8     838.5    -399.9     799.8       243 


Dispersion parameter for nbinom2 family (): 0.559 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -1.6600     0.3197  -5.192 2.08e-07 ***
child        -1.2056     0.2715  -4.441 8.95e-06 ***
persons       1.0516     0.1110   9.477  &lt; 2e-16 ***
camper        0.5834     0.2379   2.452   0.0142 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Zero-inflation model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -4.4302     1.5159  -2.923 0.003472 ** 
child         2.9263     0.8478   3.452 0.000557 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(Zinb1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">count</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Incidence Rate Ratios</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td></td>
</tr>
<tr class="odd">
<td colspan="5" style="text-align: left; font-weight: bold; padding-top: .8em;">Count Model</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.19</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.10&nbsp;–&nbsp;0.36</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">child</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.30</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.18&nbsp;–&nbsp;0.51</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">persons</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">2.86</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">2.30&nbsp;–&nbsp;3.56</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">camper</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.79</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.12&nbsp;–&nbsp;2.86</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.014</strong></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.75</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.48&nbsp;–&nbsp;2.22</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td></td>
</tr>
<tr class="odd">
<td colspan="4" style="text-align: left; font-weight: bold; padding-top: .8em;">Zero-Inflated Model</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.01</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.00&nbsp;–&nbsp;0.23</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.003</strong></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">child</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">18.66</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">3.54&nbsp;–&nbsp;98.29</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.001</strong></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">250</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.943 / 0.942</td>
<td></td>
</tr>
</tbody>
</table>


</div>
</div></li>
<li><p>What does the zero-inflation part tell you? Are groups with more children more likely to have false zeros?</p>
<ul>
<li><strong>groups with more children are more likely to have false zeros</strong> (extra zeros not explained by the count model).</li>
</ul></li>
<li><p>Plot simulated residuals using DHARMa for the best model. Do the residuals indicate problems?</p>
<ul>
<li>the model fits the model well.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(Zinb1)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="WEEK_11_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Plot residuals against <code>child</code>, <code>camper</code>, and <code>persons</code>. Are there any patterns?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate residuals</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(Zinb1)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot residuals vs predictors</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(res, data<span class="sc">$</span>child, <span class="at">main =</span> <span class="st">"Residuals vs Child"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="WEEK_11_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(res, data<span class="sc">$</span>camper, <span class="at">main =</span> <span class="st">"Residuals vs Camper"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="WEEK_11_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(res, data<span class="sc">$</span>persons, <span class="at">main =</span> <span class="st">"Residuals vs Persons"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="WEEK_11_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>What are your final conclusions about what drives fish count and zero-inflation in this dataset?</p>
<ul>
<li>I think the number of child in the group counting the fish.</li>
</ul>
<h3 id="squirrel-behavior" class="anchored"><strong>2. Squirrel behavior</strong></h3>
<p>For this exercise, you will consider the nuts data set (nuts.csv). These data were originally reported by Flaherty et al (2012). Researchers recorded information about squirrel behavior and forest attributes across various plots in Scotland’s Abernathy Forest. The study focused on the following variables:</p>
<p>cones = number of cones stripped by red squirrels per plot<br>
sntrees = standardized number of trees per plot<br>
sheight = standardized mean tree height per plot<br>
scover = standardized percentage of canopy cover per plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"nuts.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Fit and compare multiple count models:</p></li>
<li><p>Fit a Poisson model and a negative binomial model relating <code>cones</code> to <code>sntrees</code>, <code>sheight</code>, and <code>scover</code>.</p>
<ul>
<li>the negative binomial is a better model based on lower AIC.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Poisson model</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>pois_mod <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(cones <span class="sc">~</span> sntrees <span class="sc">+</span> sheight <span class="sc">+</span> scover, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> poisson, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> data2)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Negative Binomial model</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>nb_mod <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(cones <span class="sc">~</span> sntrees <span class="sc">+</span> sheight <span class="sc">+</span> scover, </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> nbinom2, </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Fit zero-inflated versions of each, assuming constant zero-inflation (<code>ziformula = ~1</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>nb_zi_1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(cones <span class="sc">~</span> sntrees <span class="sc">+</span> sheight <span class="sc">+</span> scover, </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> nbinom2,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> data2)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nb_zi_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          cones ~ sntrees + sheight + scover
Zero inflation:         ~1
Data: data2

      AIC       BIC    logLik -2*log(L)  df.resid 
    399.0     410.7    -193.5     387.0        46 


Dispersion parameter for nbinom2 family (): 1.21 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   2.7148     0.1424  19.064  &lt; 2e-16 ***
sntrees       0.2513     0.1494   1.682 0.092532 .  
sheight       0.2048     0.1528   1.341 0.180005    
scover        0.5792     0.1747   3.316 0.000914 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Zero-inflation model:
            Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)   -3.294      1.403  -2.347   0.0189 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div></li>
<li><p>Fit a hurdle model using both <code>truncated_poisson</code> and <code>truncated_nbinom2</code>. Assume a constant zero inflation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>Hurd1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(cones <span class="sc">~</span> sntrees <span class="sc">+</span> sheight <span class="sc">+</span> scover, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> data2,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>, </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"truncated_poisson"</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>Hurd2 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(cones <span class="sc">~</span> sntrees <span class="sc">+</span> sheight <span class="sc">+</span> scover, </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> data2,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>, </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"truncated_nbinom2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Compare all models using AIC.</p>
<ul>
<li>The negative binomial model is the better model with lower AIC followed by the zero-inflated model, assuming constant zero-inflation (<code>ziformula = ~1</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">AIC</span>(pois_mod,nb_mod, nb_zi_1, Hurd1, Hurd2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         df      AIC
pois_mod  4 935.3037
nb_mod    5 397.5481
nb_zi_1   6 399.0207
Hurd1     5 853.7108
Hurd2     6 401.3705</code></pre>
</div>
</div></li>
<li><p>Plot and interpret the two best models. Explain how parameters differ between a zero-inflated model and the model without zero-inflation. What do the zero-inflation model coefficients mean?</p>
<ul>
<li>the model fit for both model looks good without any deviation. the AIC between both model is slight different with ~1.5. shows that zero inflation doesnt have that much improvement on model performance compared to just negative binomial with any zero inflation.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nb_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          cones ~ sntrees + sheight + scover
Data: data2

      AIC       BIC    logLik -2*log(L)  df.resid 
    397.5     407.3    -193.8     387.5        47 


Dispersion parameter for nbinom2 family (): 1.04 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   2.6780     0.1429  18.737  &lt; 2e-16 ***
sntrees       0.2666     0.1578   1.689  0.09122 .  
sheight       0.2098     0.1585   1.324  0.18563    
scover        0.5789     0.1804   3.209  0.00133 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nb_zi_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          cones ~ sntrees + sheight + scover
Zero inflation:         ~1
Data: data2

      AIC       BIC    logLik -2*log(L)  df.resid 
    399.0     410.7    -193.5     387.0        46 


Dispersion parameter for nbinom2 family (): 1.21 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   2.7148     0.1424  19.064  &lt; 2e-16 ***
sntrees       0.2513     0.1494   1.682 0.092532 .  
sheight       0.2048     0.1528   1.341 0.180005    
scover        0.5792     0.1747   3.316 0.000914 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Zero-inflation model:
            Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)   -3.294      1.403  -2.347   0.0189 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>simulationOutput1 <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(nb_mod)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simulationOutput1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="WEEK_11_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>simulationOutput2 <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(nb_zi_1)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simulationOutput2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="WEEK_11_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Assess model fit using diagnostic plots. Plot residuals against fitted values and each predictor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for negative binomial</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>res_nb <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(nb_mod)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(res_nb, data2<span class="sc">$</span>sntrees, <span class="at">main =</span> <span class="st">"Residuals vs sntrees"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="WEEK_11_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(res_nb, data2<span class="sc">$</span>sheight, <span class="at">main =</span> <span class="st">"Residuals vs sheight"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="WEEK_11_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(res_nb, data2<span class="sc">$</span>scover, <span class="at">main =</span> <span class="st">"Residuals vs scover"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="WEEK_11_files/figure-html/unnamed-chunk-16-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#for zero inflated</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>res_nbzi <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(nb_zi_1)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(res_nbzi, data2<span class="sc">$</span>sntrees, <span class="at">main =</span> <span class="st">"ZI Residuals vs sntrees"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="WEEK_11_files/figure-html/unnamed-chunk-16-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(res_nbzi, data2<span class="sc">$</span>sheight, <span class="at">main =</span> <span class="st">"ZI Residuals vs sheight"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="WEEK_11_files/figure-html/unnamed-chunk-16-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(res_nbzi, data2<span class="sc">$</span>scover, <span class="at">main =</span> <span class="st">"ZI Residuals vs scover"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="WEEK_11_files/figure-html/unnamed-chunk-16-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ol>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>