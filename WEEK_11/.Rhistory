library(tidyverse)
data <- read.csv("fish.csv")
data <- read.csv("fish.csv")
hist(data$count)
data <- read.csv("fish.csv")
data
hist(data$count)
nb_tmb <- glmmTMB(count ~ child + persons + camper, data = data, family = nbinom2)
library(tidyverse)
library(glmmTMB)
install.packages("glmmTMB")
library(tidyverse)
library(glmmTMB)
library(DHARMa)
install.packages("DHARMa")
library(tidyverse)
library(glmmTMB)
library(DHARMa)
data <- read.csv("fish.csv")
data
hist(data$count)
nb_tmb <- glmmTMB(count ~ child + persons + camper, data = data, family = nbinom2)
summary(nb_tmb)
possion_tmb <- glmmTMB(count ~ child + persons + camper, data = data, family = possion)
nb_tmb <- glmmTMB(count ~ child + persons + camper, data = data, family = nbinom2)
summary(nb_tmb)
possion_tmb <- glmmTMB(count ~ child + persons + camper, data = data, family = poission)
nb_tmb <- glmmTMB(count ~ child + persons + camper, data = data, family = nbinom2)
summary(nb_tmb)
possion_tmb <- glmmTMB(count ~ child + persons + camper, data = data, family = Poisson)
nb_tmb <- glmmTMB(count ~ child + persons + camper, data = data, family = nbinom2)
summary(nb_tmb)
possion_tmb <- glmmTMB(count ~ child + persons + camper, data = data, family = poisson)
summary(possion_tmb)
AIC(nb_tmb, possion_tmb)
Zip1 <- glmmTMB(count ~ child + persons + camper,
ziformula = ~ child,
data = data, family = poisson)
summary(Zip1)
Zip1 <- glmmTMB(count ~ child + persons + camper,
ziformula = ~ child,
data = data, family = poisson)
summary(Zip1)
Zinb1 <- glmmTMB(count ~ child + persons + camper,
ziformula = ~ child,
data = data, family = nbinom2)
summary(Zinb1)
Zinb1 <- glmmTMB(count ~ child + persons + camper,
ziformula = ~ child,
data = data, family = nbinom2)
summary(Zinb1)
AIC(Zip1, Zinb1)
AIC(Zip1, Zinb1, nb_tmb, possion_tmb)
AIC(Zip1, Zinb1, nb_tmb, possion_tmb)
summary(Zinb1)
library(tidyverse)
library(glmmTMB)
library(DHARMa)
library(sjPlot)
summary(Zinb1)
tab_model(Zinb1)
simulationOutput <- simulateResiduals(Zinb1)
plot(simulationOutput)
# Simulate residuals
res <- simulateResiduals(Zinb1)
# Plot general residual diagnostics
plot(res)
# Plot residuals vs predictors
plotResiduals(res, data$child, main = "Residuals vs Child")
plotResiduals(res, data$camper, main = "Residuals vs Camper")
plotResiduals(res, data$persons, main = "Residuals vs Persons")
data2 <- read.csv("nuts.csv")
# Poisson model
pois_mod <- glmmTMB(cones ~ sntrees + sheight + scover,
family = poisson,
data = data2)
# Negative Binomial model
nb_mod <- glmmTMB(cones ~ sntrees + sheight + scover,
family = nbinom2,
data = data2)
# Poisson model
pois_mod <- glmmTMB(cones ~ sntrees + sheight + scover,
family = poisson,
data = data2)
# Negative Binomial model
nb_mod <- glmmTMB(cones ~ sntrees + sheight + scover,
family = nbinom2,
data = data2)
AIC(pois_mod,nb_mod)
nb_zi_1 <- glmmTMB(cones ~ sntrees + sheight + scover,
family = nbinom2,
ziformula = ~1,
data = data2)
nb_zi_1 <- glmmTMB(cones ~ sntrees + sheight + scover,
family = nbinom2,
ziformula = ~1,
data = data2)
summary(nb_zi_1)
Hurd1 <- glmmTMB(cones ~ sntrees + sheight + scover,
family = nbinom2,
data = data2,
family = "truncated_poisson")
Hurd1 <- glmmTMB(cones ~ sntrees + sheight + scover,
data = data2,
family = "truncated_poisson")
Hurd1 <- glmmTMB(cones ~ sntrees + sheight + scover,
data = data2,
ziformula = ~1,
family = "truncated_poisson")
Hurd2 <- glmmTMB(cones ~ sntrees + sheight + scover,
data = data2,
ziformula = ~1,
family = "truncated_nbinom2")
AIC(pois_mod,nb_mod, nb_zi_1, Hurd1, Hurd2)
AIC(pois_mod,nb_mod, nb_zi_1, Hurd1, Hurd2)
simulationOutput1 <- simulateResiduals(nb_mod)
plot(simulationOutput1)
simulationOutput2 <- simulateResiduals(nb_zi_1)
plot(simulationOutput2)
summary(nb_mod)
summary(nb_zi_1)
simulationOutput1 <- simulateResiduals(nb_mod)
plot(simulationOutput1)
simulationOutput2 <- simulateResiduals(nb_zi_1)
plot(simulationOutput2)
# Simulate residuals
res_nb <- simulateResiduals(nb_mod)
plotResiduals(res_nb, data2$sntrees, main = "Residuals vs sntrees")
plotResiduals(res_nb, data2$sheight, main = "Residuals vs sheight")
plotResiduals(res_nb, data2$scover, main = "Residuals vs scover")
# for negative binomial
res_nb <- simulateResiduals(nb_mod)
plotResiduals(res_nb, data2$sntrees, main = "Residuals vs sntrees")
plotResiduals(res_nb, data2$sheight, main = "Residuals vs sheight")
plotResiduals(res_nb, data2$scover, main = "Residuals vs scover")
#for zero inflated
res_nbzi <- simulateResiduals(nb_zi_1)
plotResiduals(res_nbzi, data2$sntrees, main = "ZI Residuals vs sntrees")
plotResiduals(res_nbzi, data2$sheight, main = "ZI Residuals vs sheight")
plotResiduals(res_nbzi, data2$scover, main = "ZI Residuals vs scover")
