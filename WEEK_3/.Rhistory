#load your packages
library(tidyverse)
data_1 <- read.csv("RIKZdat.csv")
data_1 <- read.csv("RIKZdat.csv")
head(data_1)
##plot of x and y
plot(data_1$NAP~data_1$Richness)
lm_1 <- lm(y = data_1$Richness, x = data_1$NAP)
lm_1 <- lm(y = data_1$Richness ~ x = data_1$NAP)
lm_1 <- lm( data_1$Richness ~ data_1$NAP)
ggplot(data_1, aes(x = NAP, y = Richness)) +
geom_point(size = 2, color = "red") +
geom_smooth(method = "lm", color = "black") +
theme_bw()
#load your packages
library(tidyverse)
library(sjplot)
install.packages("sjPlot")
#load your packages
library(tidyverse)
library(sjPlot)
tab_model(lm_1)
anova(lm_1)
par(mfrow = c(2, 2))
plot(lm_1)
#par(mfrow = c(2, 2))
plot(lm_1)
par(mfrow = c(2, 2))
plot(lm_1)
par(mfrow = c(1, 1))
plot(lm_1)
par(mfrow = c(2, 2))
plot(lm_1)
#par(mfrow = c(2, 2))
plot(lm_1)
#read the data
data_2 <- read.csv("knees.csv")
#read the data
data_2 <- read.csv("knees.csv")
head(data_2)
data_2$treatment <- as.factor(data_2$treatment)
ggplot(data_2, aes(x = treatment, y = shift, fill = treatment)) +
geom_boxplot() +
scale_fill_brewer(palette = "Accent") +
theme_bw()
#read the data
data_2 <- read.csv("knees.csv")
head(data_2)
ggplot(data_2, aes(x = treatment, y = shift, fill = treatment)) +
geom_boxplot() +
scale_fill_brewer(palette = "Accent") +
theme_bw()
table(data_2$treatment)
data_2$treatment <- as.factor(data_2$treatment)
levels(data_2$treatment)
data_2$treatment <- factor(data_2$treatment, levels = c("control", "knee", "eyes"))
ggplot(data_2, aes(x = treatment, y = shift, fill = treatment)) +
geom_boxplot() +
scale_fill_brewer(palette = "Accent") +
theme_bw()
lm_2 <- lm(shift ~ treatment, data = data_2)
summary(model3)
lm_2 <- lm(shift ~ treatment, data = data_2)
tab_model(lm_2)
fit <- lm_2$fitted.values
# Plot observed data
plot(data_2$treatment, data_2$phase_shift,
main = "Observed vs Fitted Phase Shift",
xlab = "Treatment",
ylab = "Phase Shift",
pch = 16, col = "blue")
# Add fitted values as red points (slightly offset for visibility)
points(data_2$treatment, fit, col = "red", pch = 17)
# Add a legend
legend("topright", legend = c("Observed", "Fitted"),
col = c("blue", "red"), pch = c(16, 17))
plot(lm_2)
anova(lm_2)
#load your packages
library(tidyverse)
library(sjPlot)
library(emmeans)
# Get estimated marginal means (EMMs)
emmeans_lm <- emmeans(lm_2, ~ treatment)
# Show means, standard errors, and 95% confidence intervals
summary(emmeans_lm, infer = c(TRUE, TRUE))
data_3 <- read.csv("fruitflies.csv")
data_3 <- read.csv("fruitflies.csv")
head(data_3)
levels(data_3$treatment)
levels(data_2$treatment)
data_2$treatment <- as.factor(data_2$treatment)
levels(data_3$treatment)
data_3$treatment <- as.factor(data_3$treatment)
levels(data_3$treatment)
data_3$treatment <- factor(data_3$treatment, levels = c("no females added","1 virgin female",
"1 pregnant female","8 virgin females","8 pregnant females"))
plot(data_3$thorax.mm~data_3$longevity.days)
ggplot(data_3, aes(x = thorax.mm, y = longevity.days,
color = treatment, shape = treatment)) +
geom_point(size = 3, alpha = 0.8) +
labs(title = "Longevity vs Body Size by Treatment",
x = "Thorax Length",
y = "Longevity") +
theme_minimal() +
scale_color_brewer(palette = "Set2")  # optional, nice color palette
lm_3 <- lm(data_3$longevity.days~data_3$thorax.mm+data_3$treatment)
plot(lm_3)
data_3$longevity.days <- log(data_3$longevity.days)
data_3$longevity.days <- log(data_3$longevity.days)
lm_log <- lm(data_3$longevity.days~data_3$thorax.mm+data_3$treatment)
plot(lm_log)
install.packages("visreg")
#load your packages
library(tidyverse)
library(sjPlot)
library(emmeans)
library(visreg)
visreg(lm_3, "thorax.mm", by = "treatment")
lm_3 <- lm(data_3$longevity.days~data_3$thorax.mm+data_3$treatment)
visreg(lm_3, "thorax.mm", by = "treatment")
lm_3 <- lm(longevity.days~thorax.mm+$treatment)
lm_3 <- lm(longevity.days~thorax.mm+treatment)
lm_3 <- lm(longevity.days~thorax.mm+treatment, data = data_3)
visreg(lm_3, "thorax.mm", by = "treatment")
tab_model(lm_3)
summary(lm_3)
tab_model(lm_3)
summary(lm_3)
tab_model(lm_3)
# 95% confidence intervals
confint(lm_3)
anova(lm_3)
lm_4 <- lm(longevity.days ~ treatment + thorax.mm, data = data_3)
anova(lm_4)
# Linear model with interaction
lm_interact <- lm(longevity.days ~ thorax.mm * treatment, data = data_3)
# View summary
summary(lm_interact)
# Linear model with interaction
lm_interact <- lm(longevity.days ~ thorax.mm * treatment, data = data_3)
# View summary
summary(lm_interact)
tab_model(lm_interact)
summary(lm_3)$adj.r.squared
summary(lm_interact)$adj.r.squared
