<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ogonna Eli">

<title>WEEK 6</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="WEEK_6_files/libs/clipboard/clipboard.min.js"></script>
<script src="WEEK_6_files/libs/quarto-html/quarto.js"></script>
<script src="WEEK_6_files/libs/quarto-html/popper.min.js"></script>
<script src="WEEK_6_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="WEEK_6_files/libs/quarto-html/anchor.min.js"></script>
<link href="WEEK_6_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="WEEK_6_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="WEEK_6_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="WEEK_6_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="WEEK_6_files/libs/bootstrap/bootstrap-8a79a254b8e706d3c925cde0a310d4f0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">WEEK 6</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ogonna Eli </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="maryland-biological-stream-survey" class="level2">
<h2 class="anchored" data-anchor-id="maryland-biological-stream-survey"><strong>Maryland Biological Stream Survey</strong></h2>
<p>We are interested in exploring the relationship between abundance of longnose dace and chemical and biological characteristics of the streams in which they were counted.</p>
<p><strong>Predictors in the dataset include:</strong></p>
<ul>
<li><p><strong>stream</strong>: name of each sampled stream (i.e., the name associated with each case)</p></li>
<li><p><strong>longnosedace</strong>: number of longnose dace (<em>Rhinichthys cataractae</em>) per 75-meter section of stream</p></li>
<li><p><strong>acreage</strong>: area (in acres) drained by the stream</p></li>
<li><p><strong>do2</strong>: dissolved oxygen (mg/liter)</p></li>
<li><p><strong>maxdepth</strong>: maximum depth (cm) of the 75-meter segment of stream</p></li>
<li><p><strong>no3</strong>: nitrate concentration (mg/liter)</p></li>
<li><p><strong>so4</strong>: sulfate concentration (mg/liter)</p></li>
<li><p><strong>temp</strong>: water temperature on the sampling date (°C)</p></li>
</ul>
<section id="read-in-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="read-in-the-dataset"><strong>Read in the dataset</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.4.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   4.0.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'

The following object is masked from 'package:dplyr':

    collapse</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'MASS' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'

The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'MuMIn' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'performance' was built under R version 4.4.3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"longnosedace.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li><div>
<h3 id="fit-a-model-containing-all-predictor-variables-except-stream" class="anchored"><strong>Fit a model containing all predictor variables (except <code>stream</code>)</strong></h3>
</div>
<ul>
<li><p>Scale the predictors in the model</p></li>
<li><p>Using estimated coefficients and SEs, comment on:</p>
<ol type="1">
<li><p>Statistical significance (evidence coefficients ≠ 0)</p></li>
<li><p>Potential biological significance (magnitude of estimated effects)</p></li>
</ol></li>
<li><p>Assume assumptions are met for now</p></li>
<li><p>The relationship is significant overall (P value &lt;0.05) but some variables aren’t significant. the area drained by the stream (acreage) and nitrate concentration are the variables that have a significant impact on number of longnose dace. so the higher the area drained and the higher the no3 concentration the higher the number of longnose dace.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scale the predictors</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>z_acreage <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>acreage)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>z_do2 <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>do2)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>z_maxdepth <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>maxdepth)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>z_no3 <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>no3)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>z_so4 <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>so4)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>z_temp <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>temp)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(longnosedace <span class="sc">~</span> z_acreage <span class="sc">+</span> z_do2 <span class="sc">+</span> z_maxdepth <span class="sc">+</span> z_no3 <span class="sc">+</span> z_so4 <span class="sc">+</span> z_temp, <span class="at">data =</span> df)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = longnosedace ~ z_acreage + z_do2 + z_maxdepth + 
    z_no3 + z_so4 + z_temp, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-57.428 -25.028  -2.215  10.667 170.017 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 38.80882    4.97793   7.796 9.87e-11 ***
z_acreage   15.21323    5.23504   2.906  0.00509 ** 
z_do2        6.28759    5.54600   1.134  0.26135    
z_maxdepth  10.37964    5.22950   1.985  0.05167 .  
z_no3       14.05077    5.29259   2.655  0.01011 *  
z_so4       -0.05636    5.06576  -0.011  0.99116    
z_temp       8.64289    5.32874   1.622  0.10997    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 41.05 on 61 degrees of freedom
Multiple R-squared:  0.314, Adjusted R-squared:  0.2465 
F-statistic: 4.653 on 6 and 61 DF,  p-value: 0.0005905</code></pre>
</div>
</div></li>
<li><div>
<h3 id="find-the-optimal-fixed-effects-structure" class="anchored"><strong>Find the optimal fixed effects structure</strong></h3>
</div>
<ul>
<li><p>Use log-likelihood ratio tests (LRT) to compare reduced models against the full model</p></li>
<li><p>Identify the minimum adequate model</p></li>
<li><p>Based on lower AIC, the model without the random effect by the stream is the best performing model. since adding the random effect doesnt improve the model, we will find the optimal fixed effects from the full model without any random effect. The minimum adequate model is the area drained, the max depth, no3. so these variables are the ones mostly adequate to explain our response.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">##fit a gls model to compare the model selection result with.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>gls1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(longnosedace <span class="sc">~</span> z_acreage <span class="sc">+</span> z_do2 <span class="sc">+</span> z_maxdepth <span class="sc">+</span> z_no3 <span class="sc">+</span> z_so4 <span class="sc">+</span> z_temp, <span class="at">data =</span> df)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gls1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized least squares fit by REML
  Model: longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 +      z_temp 
  Data: df 
      AIC      BIC   logLik
  671.456 688.3429 -327.728

Coefficients:
               Value Std.Error   t-value p-value
(Intercept) 38.80882  4.977931  7.796176  0.0000
z_acreage   15.21323  5.235043  2.906038  0.0051
z_do2        6.28759  5.545999  1.133716  0.2613
z_maxdepth  10.37964  5.229503  1.984824  0.0517
z_no3       14.05077  5.292590  2.654801  0.0101
z_so4       -0.05636  5.065762 -0.011125  0.9912
z_temp       8.64289  5.328738  1.621939  0.1100

 Correlation: 
           (Intr) z_acrg z_do2  z_mxdp z_no3  z_so4 
z_acreage   0.000                                   
z_do2       0.000 -0.029                            
z_maxdepth  0.000 -0.268  0.082                     
z_no3       0.000  0.112 -0.289 -0.081              
z_so4       0.000 -0.055  0.031  0.062  0.067       
z_temp      0.000 -0.010  0.330  0.028 -0.100 -0.065

Standardized residuals:
        Min          Q1         Med          Q3         Max 
-1.39900410 -0.60970039 -0.05395717  0.25985738  4.14178791 

Residual standard error: 41.04907 
Degrees of freedom: 68 total; 61 residual</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We add stream as a random intercept to account for species being grouped by stream</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>lme1 <span class="ot">&lt;-</span> <span class="fu">lme</span>(longnosedace <span class="sc">~</span> z_acreage <span class="sc">+</span> z_do2 <span class="sc">+</span> z_maxdepth <span class="sc">+</span> z_no3 <span class="sc">+</span> z_so4 <span class="sc">+</span> z_temp,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> stream,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">method =</span> <span class="st">"REML"</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(lme1)</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Compare models using maximum likelihood to see if adding random effects improves fit.</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>gls1_ml <span class="ot">&lt;-</span> <span class="fu">update</span>(gls1, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>lme1_ml <span class="ot">&lt;-</span> <span class="fu">update</span>(lme1, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#anova(gls1_ml, lme1_ml)</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="do">##since addint the random effect doesnt improve the model, we will find the optimal fixed effects from the full model without any random effect</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>lme1_ml <span class="ot">&lt;-</span> <span class="fu">update</span>(gls1, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(lme1_ml, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + 
    z_temp
           Df    AIC    LRT Pr(&gt;Chi)   
&lt;none&gt;        706.80                   
z_acreage   1 713.61 8.8170 0.002984 **
z_do2       1 706.21 1.4179 0.233746   
z_maxdepth  1 709.05 4.2556 0.039121 * 
z_no3       1 712.23 7.4351 0.006397 **
z_so4       1 704.80 0.0001 0.990629   
z_temp      1 707.67 2.8711 0.090184 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit the better model</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>fit_model_LRT <span class="ot">&lt;-</span>  <span class="fu">gls</span>(longnosedace <span class="sc">~</span> z_acreage <span class="sc">+</span>  z_maxdepth <span class="sc">+</span> z_no3 , <span class="at">data =</span> df)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_model_LRT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized least squares fit by REML
  Model: longnosedace ~ z_acreage + z_maxdepth + z_no3 
  Data: df 
       AIC      BIC    logLik
  683.9017 694.6961 -336.9508

Coefficients:
               Value Std.Error  t-value p-value
(Intercept) 38.80882  4.979368 7.793925  0.0000
z_acreage   15.40725  5.226436 2.947947  0.0045
z_maxdepth   9.86458  5.203909 1.895610  0.0625
z_no3       15.79907  5.051946 3.127323  0.0027

 Correlation: 
           (Intr) z_acrg z_mxdp
z_acreage   0.000              
z_maxdepth  0.000 -0.264       
z_no3       0.000  0.113 -0.065

Standardized residuals:
       Min         Q1        Med         Q3        Max 
-1.9420514 -0.5025377 -0.1415667  0.2444877  4.2260784 

Residual standard error: 41.06092 
Degrees of freedom: 68 total; 64 residual</code></pre>
</div>
</div></li>
<li><div>
<h3 id="use-stepaic-to-find-the-best-model" class="anchored"><strong>Use <code>stepAIC</code> to find the “best” model</strong></h3>
</div>
<ul>
<li><p>Compare results with those from LRT-based selection</p></li>
<li><p>PS: StepAIC favors variablesthat makes the model AIC go up which is what the model doesn’t want. so if it takes out so4, it goes down to 704; which is what the model wants. so it takes it out, same for do2. these variables lower the AIC which is good, so they’re taken out. but other variables when taken out increases the AIC therefore, they are left in since the step AIC tries to keep the lower AIC with fewer variables.</p></li>
<li><p>The two model have the same variable, max depth, no3 and acreage.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>step_model <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(lme1_ml, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=706.8
longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + 
    z_temp

             Df    AIC
- z_so4       1 704.80
- z_do2       1 706.21
&lt;none&gt;          706.80
- z_temp      1 707.67
- z_maxdepth  1 709.05
- z_no3       1 712.23
- z_acreage   1 713.61

Step:  AIC=704.8
longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_temp

             Df    AIC
- z_do2       1 704.22
&lt;none&gt;          704.80
- z_temp      1 705.68
- z_maxdepth  1 707.07
- z_no3       1 710.27
- z_acreage   1 711.64

Step:  AIC=704.22
longnosedace ~ z_acreage + z_maxdepth + z_no3 + z_temp

             Df    AIC
- z_temp      1 704.10
&lt;none&gt;          704.22
- z_maxdepth  1 706.06
- z_acreage   1 711.07
- z_no3       1 712.15

Step:  AIC=704.1
longnosedace ~ z_acreage + z_maxdepth + z_no3

             Df    AIC
&lt;none&gt;          704.10
- z_maxdepth  1 705.82
- z_acreage   1 710.76
- z_no3       1 711.77</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized least squares fit by maximum likelihood
  Model: longnosedace ~ z_acreage + z_maxdepth + z_no3 
  Data: df 
       AIC      BIC    logLik
  704.1009 715.1984 -347.0505

Coefficients:
               Value Std.Error  t-value p-value
(Intercept) 38.80882  4.979368 7.793925  0.0000
z_acreage   15.40725  5.226436 2.947947  0.0045
z_maxdepth   9.86458  5.203909 1.895610  0.0625
z_no3       15.79907  5.051946 3.127323  0.0027

 Correlation: 
           (Intr) z_acrg z_mxdp
z_acreage   0.000              
z_maxdepth  0.000 -0.264       
z_no3       0.000  0.113 -0.065

Standardized residuals:
       Min         Q1        Med         Q3        Max 
-2.0018208 -0.5180040 -0.1459236  0.2520121  4.3561419 

Residual standard error: 39.83495 
Degrees of freedom: 68 total; 64 residual</code></pre>
</div>
</div></li>
<li><div>
<h3 id="fit-the-model-chosen-by-stepaic" class="anchored"><strong>Fit the model chosen by <code>stepAIC</code></strong></h3>
</div>
<ul>
<li>Inspect coefficients and statistical significance</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit the better model</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>fit_model_StepAIC <span class="ot">&lt;-</span>  <span class="fu">gls</span>(longnosedace <span class="sc">~</span> z_acreage <span class="sc">+</span>  z_maxdepth <span class="sc">+</span> z_no3 , <span class="at">data =</span> df)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_model_StepAIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized least squares fit by REML
  Model: longnosedace ~ z_acreage + z_maxdepth + z_no3 
  Data: df 
       AIC      BIC    logLik
  683.9017 694.6961 -336.9508

Coefficients:
               Value Std.Error  t-value p-value
(Intercept) 38.80882  4.979368 7.793925  0.0000
z_acreage   15.40725  5.226436 2.947947  0.0045
z_maxdepth   9.86458  5.203909 1.895610  0.0625
z_no3       15.79907  5.051946 3.127323  0.0027

 Correlation: 
           (Intr) z_acrg z_mxdp
z_acreage   0.000              
z_maxdepth  0.000 -0.264       
z_no3       0.000  0.113 -0.065

Standardized residuals:
       Min         Q1        Med         Q3        Max 
-1.9420514 -0.5025377 -0.1415667  0.2444877  4.2260784 

Residual standard error: 41.06092 
Degrees of freedom: 68 total; 64 residual</code></pre>
</div>
</div></li>
<li><div>
<h3 id="fit-all-possible-models" class="anchored"><strong>Fit all possible models</strong></h3>
</div>
<ul>
<li><p>Use <code>dredge()</code> to consider all combinations of predictors</p></li>
<li><p>Is there a clear “best” model based on AIC?</p></li>
<li><p>It did put out a lot of result. yes, acreage, no3 and max depth are among the top 2 performing model.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate all subsets of the full ML model</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>all_models <span class="ot">&lt;-</span> <span class="fu">dredge</span>(gls1_ml)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Fixed term is "(Intercept)"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the top models</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>all_models</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Global model call: gls(model = longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + 
    z_so4 + z_temp, data = df, method = "ML")
---
Model selection table 
   (Int) z_acr  z_do2  z_mxd z_no3    z_so4  z_tmp df   logLik  AICc delta
14 38.81 15.41         9.865 15.80                  5 -347.050 705.1  0.00
46 38.81 15.37         9.906 15.80           6.633  6 -346.109 705.6  0.53
10 38.81 18.02               16.42                  4 -348.908 706.5  1.38
48 38.81 15.21  6.290 10.380 14.05           8.639  7 -345.399 706.7  1.60
42 38.81 18.00               16.43           6.577  5 -348.032 707.0  1.96
16 38.81 15.33  3.296 10.110 14.88                  6 -346.839 707.1  1.99
30 38.81 15.39         9.883 15.82  0.29900         6 -347.049 707.5  2.41
62 38.81 15.39         9.891 15.79 -0.23440  6.652  7 -346.107 708.1  3.01
44 38.81 17.97  5.400        14.95           8.296  6 -347.536 708.4  3.38
12 38.81 18.01  2.544        15.72                  5 -348.788 708.5  3.47
26 38.81 18.03               16.39 -0.27290         5 -348.906 708.8  3.71
64 38.81 15.21  6.288 10.380 14.05 -0.05636  8.643  8 -345.399 709.2  4.17
58 38.81 18.03               16.36 -0.80590  6.641  6 -348.019 709.4  4.35
32 38.81 15.30  3.323 10.140 14.91  0.47750         7 -346.834 709.5  4.47
60 38.81 17.99  5.381        14.90 -0.67770  8.344  7 -347.526 710.9  5.85
28 38.81 18.01  2.537        15.71 -0.14800         6 -348.787 711.0  5.88
13 38.81              13.910 14.12                  4 -351.380 711.4  6.33
40 38.81 13.60 10.600 11.560                10.000  6 -349.134 711.6  6.58
45 38.81              13.940 14.13           6.705  5 -350.534 712.0  6.97
6  38.81 13.56        10.910                        4 -351.885 712.4  7.34
8  38.81 13.62  7.396 11.320                        5 -350.872 712.7  7.64
47 38.81        6.735 14.410 12.27           8.852  6 -349.818 713.0  7.94
38 38.81 13.53        10.960                 6.620  5 -351.073 713.1  8.05
15 38.81        3.670 14.160 13.11                  5 -351.148 713.3  8.20
29 38.81              13.960 14.21  1.11300         5 -351.357 713.7  8.61
36 38.81 16.57  9.908                        9.715  5 -351.518 714.0  8.93
56 38.81 13.66 10.550 11.500       -0.95380 10.060  7 -349.116 714.1  9.03
2  38.81 16.39                                      3 -353.862 714.1  9.03
61 38.81              13.970 14.18  0.57880  6.659  6 -350.527 714.4  9.36
22 38.81 13.63        10.850       -0.94530         5 -351.869 714.7  9.64
4  38.81 16.54  6.810                               4 -353.052 714.7  9.67
34 38.81 16.36                               6.556  4 -353.112 714.9  9.79
24 38.81 13.65  7.367 11.300       -0.39070         6 -350.869 715.1 10.05
54 38.81 13.63        10.860       -1.48300  6.737  6 -351.033 715.4 10.37
63 38.81        6.759 14.450 12.33  0.76030  8.799  7 -349.807 715.5 10.41
31 38.81        3.744 14.220 13.20  1.30900         6 -351.117 715.6 10.54
39 38.81       10.510 15.080                10.040  5 -352.398 715.8 10.69
9  38.81                     14.62                  3 -354.794 716.0 10.89
5  38.81              14.420                        3 -354.892 716.2 11.09
18 38.81 16.47                     -1.62500         4 -353.817 716.3 11.20
52 38.81 16.65  9.821              -1.70700  9.823  6 -351.464 716.3 11.24
7  38.81        7.293 14.840                        4 -353.992 716.6 11.55
41 38.81                     14.63           6.637  4 -354.045 716.7 11.66
37 38.81              14.460                 6.685  4 -354.135 716.9 11.84
20 38.81 16.59  6.728              -1.14400         5 -353.029 717.0 11.96
50 38.81 16.47                     -2.16200  6.728  5 -353.030 717.0 11.96
11 38.81        2.638        13.90                  4 -354.686 718.0 12.94
55 38.81       10.500 15.070       -0.11140 10.050  6 -352.397 718.2 13.10
43 38.81        5.528        13.13           8.398  5 -353.610 718.2 13.12
25 38.81                     14.66  0.45570         4 -354.791 718.2 13.15
21 38.81              14.420       -0.10290         4 -354.892 718.4 13.35
23 38.81        7.327 14.870        0.45010         5 -353.988 718.9 13.88
57 38.81                     14.63 -0.07750  6.644  5 -354.045 719.1 13.99
53 38.81              14.420       -0.64000  6.736  5 -354.128 719.2 14.15
27 38.81        2.668        13.94  0.58640         5 -354.680 720.3 15.26
59 38.81        5.529        13.13  0.05272  8.394  6 -353.610 720.6 15.53
1  38.81                                            2 -358.211 720.6 15.54
35 38.81        9.515                        9.648  4 -356.254 721.1 16.08
33 38.81                                     6.614  3 -357.540 721.5 16.39
3  38.81        6.439                               3 -357.575 721.5 16.46
17 38.81                           -0.82190         3 -358.201 722.8 17.71
51 38.81        9.468              -0.91070  9.706  5 -356.241 723.5 18.38
49 38.81                           -1.35800  6.723  4 -357.511 723.7 18.59
19 38.81        6.413              -0.35750         4 -357.573 723.8 18.71
   weight
14  0.188
46  0.145
10  0.094
48  0.085
42  0.070
16  0.070
30  0.056
62  0.042
44  0.035
12  0.033
26  0.029
64  0.023
58  0.021
32  0.020
60  0.010
28  0.010
13  0.008
40  0.007
45  0.006
6   0.005
8   0.004
47  0.004
38  0.003
15  0.003
29  0.003
36  0.002
56  0.002
2   0.002
61  0.002
22  0.002
4   0.001
34  0.001
24  0.001
54  0.001
63  0.001
31  0.001
39  0.001
9   0.001
5   0.001
18  0.001
52  0.001
7   0.001
41  0.001
37  0.001
20  0.000
50  0.000
11  0.000
55  0.000
43  0.000
25  0.000
21  0.000
23  0.000
57  0.000
53  0.000
27  0.000
59  0.000
1   0.000
35  0.000
33  0.000
3   0.000
17  0.000
51  0.000
49  0.000
19  0.000
Models ranked by AICc(x) </code></pre>
</div>
</div></li>
<li><div>
<h3 id="model-averaging-δaic-4" class="anchored"><strong>Model averaging (ΔAIC &lt; 4)</strong></h3>
</div>
<ul>
<li>Average coefficients across models within 4 AIC units of the best model</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average only models within delta &lt; 4</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>avg_model <span class="ot">&lt;-</span> <span class="fu">model.avg</span>(all_models, <span class="at">subset =</span> delta <span class="sc">&lt;</span> <span class="dv">4</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(avg_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
model.avg(object = all_models, subset = delta &lt; 4)

Component model call: 
gls(model = longnosedace ~ &lt;11 unique rhs&gt;, data = df, method = ML)

Component models: 
      df  logLik   AICc delta weight
134    5 -347.05 705.07  0.00   0.22
1346   6 -346.11 705.59  0.53   0.17
14     4 -348.91 706.45  1.38   0.11
12346  7 -345.40 706.66  1.60   0.10
146    5 -348.03 707.03  1.96   0.08
1234   6 -346.84 707.05  1.99   0.08
1345   6 -347.05 707.47  2.41   0.07
13456  7 -346.11 708.08  3.01   0.05
1246   6 -347.54 708.45  3.38   0.04
124    5 -348.79 708.54  3.47   0.04
145    5 -348.91 708.78  3.71   0.03

Term codes: 
 z_acreage      z_do2 z_maxdepth      z_no3      z_so4     z_temp 
         1          2          3          4          5          6 

Model-averaged coefficients:  
(full average) 
             Estimate Std. Error Adjusted SE z value Pr(&gt;|z|)    
(Intercept) 38.808824   5.005346    5.102641   7.606  &lt; 2e-16 ***
z_acreage   16.176666   5.339226    5.437622   2.975  0.00293 ** 
z_maxdepth   6.896079   6.325422    6.383528   1.080  0.28001    
z_no3       15.654604   5.180818    5.279805   2.965  0.00303 ** 
z_temp       3.210452   4.988730    5.034722   0.638  0.52369    
z_do2        1.220578   3.536683    3.579658   0.341  0.73312    
z_so4       -0.001073   1.983974    2.022770   0.001  0.99958    

(conditional average) 
             Estimate Std. Error Adjusted SE z value Pr(&gt;|z|)    
(Intercept) 38.808824   5.005346    5.102641   7.606  &lt; 2e-16 ***
z_acreage   16.176666   5.339226    5.437622   2.975  0.00293 ** 
z_maxdepth   9.982469   5.206570    5.308233   1.881  0.06003 .  
z_no3       15.654604   5.180818    5.279805   2.965  0.00303 ** 
z_temp       7.229862   5.194816    5.293795   1.366  0.17203    
z_do2        4.653879   5.631467    5.734065   0.812  0.41701    
z_so4       -0.007124   5.112407    5.212380   0.001  0.99891    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit the better model</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>fit_model_dredge <span class="ot">&lt;-</span>  <span class="fu">gls</span>(longnosedace <span class="sc">~</span> z_acreage <span class="sc">+</span>   z_no3 , <span class="at">data =</span> df)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_model_dredge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized least squares fit by REML
  Model: longnosedace ~ z_acreage + z_no3 
  Data: df 
       AIC      BIC    logLik
  690.5813 699.2788 -341.2906

Coefficients:
               Value Std.Error  t-value p-value
(Intercept) 38.80882  5.077729 7.642949  0.0000
z_acreage   18.01996  5.141009 3.505141  0.0008
z_no3       16.41688  5.141009 3.193319  0.0022

 Correlation: 
          (Intr) z_acrg
z_acreage 0.0          
z_no3     0.0    0.1   

Standardized residuals:
       Min         Q1        Med         Q3        Max 
-1.6738847 -0.4518579 -0.1834848  0.2334075  4.5843494 

Residual standard error: 41.87203 
Degrees of freedom: 68 total; 65 residual</code></pre>
</div>
</div></li>
<li><div>
<h3 id="confidence-set-of-models" class="anchored"><strong>95% confidence set of models</strong></h3>
</div>
<ul>
<li><p>Use cumulative weight ≤ 0.95 to identify the set of models in the “confidence set”</p></li>
<li><p>I think the models with the highest weight? I have a bit issue with understanding the question.</p></li>
</ul></li>
<li><div>
<h3 id="model-averaged-coefficients-for-the-confidence-set" class="anchored"><strong>Model-averaged coefficients for the confidence set</strong></h3>
</div>
<ul>
<li><p>Average coefficients across models in the 95% confidence set</p></li>
<li><p>Interpret “full” vs “conditional” averages</p></li>
<li><p><strong>Full average</strong>: Assigns 0 to predictors not present in a given model before averaging — shrinks weak parameters toward zero (more conservative; recommended for interpretation).</p></li>
<li><p><strong>Conditional average</strong>: Averages only across models where the predictor is included — can give larger effect sizes for predictors with low support.</p></li>
<li><p><strong>full average</strong> is used to assess importance of predictors.</p></li>
<li><p><strong>conditional average</strong> is use to report effect size when included.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average only models within delta &lt; 4</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>avg_model <span class="ot">&lt;-</span> <span class="fu">model.avg</span>(all_models, <span class="at">subset =</span> delta <span class="sc">&lt;</span> <span class="dv">4</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(avg_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
model.avg(object = all_models, subset = delta &lt; 4)

Component model call: 
gls(model = longnosedace ~ &lt;11 unique rhs&gt;, data = df, method = ML)

Component models: 
      df  logLik   AICc delta weight
134    5 -347.05 705.07  0.00   0.22
1346   6 -346.11 705.59  0.53   0.17
14     4 -348.91 706.45  1.38   0.11
12346  7 -345.40 706.66  1.60   0.10
146    5 -348.03 707.03  1.96   0.08
1234   6 -346.84 707.05  1.99   0.08
1345   6 -347.05 707.47  2.41   0.07
13456  7 -346.11 708.08  3.01   0.05
1246   6 -347.54 708.45  3.38   0.04
124    5 -348.79 708.54  3.47   0.04
145    5 -348.91 708.78  3.71   0.03

Term codes: 
 z_acreage      z_do2 z_maxdepth      z_no3      z_so4     z_temp 
         1          2          3          4          5          6 

Model-averaged coefficients:  
(full average) 
             Estimate Std. Error Adjusted SE z value Pr(&gt;|z|)    
(Intercept) 38.808824   5.005346    5.102641   7.606  &lt; 2e-16 ***
z_acreage   16.176666   5.339226    5.437622   2.975  0.00293 ** 
z_maxdepth   6.896079   6.325422    6.383528   1.080  0.28001    
z_no3       15.654604   5.180818    5.279805   2.965  0.00303 ** 
z_temp       3.210452   4.988730    5.034722   0.638  0.52369    
z_do2        1.220578   3.536683    3.579658   0.341  0.73312    
z_so4       -0.001073   1.983974    2.022770   0.001  0.99958    

(conditional average) 
             Estimate Std. Error Adjusted SE z value Pr(&gt;|z|)    
(Intercept) 38.808824   5.005346    5.102641   7.606  &lt; 2e-16 ***
z_acreage   16.176666   5.339226    5.437622   2.975  0.00293 ** 
z_maxdepth   9.982469   5.206570    5.308233   1.881  0.06003 .  
z_no3       15.654604   5.180818    5.279805   2.965  0.00303 ** 
z_temp       7.229862   5.194816    5.293795   1.366  0.17203    
z_do2        4.653879   5.631467    5.734065   0.812  0.41701    
z_so4       -0.007124   5.112407    5.212380   0.001  0.99891    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div></li>
<li><div>
<h3 id="cross-validation-of-the-best-model" class="anchored"><strong>Cross-validation of the best model</strong></h3>
</div>
<ul>
<li><p>Perform k-fold CV on the best model from <code>dredge()</code></p></li>
<li><p>Compare CV R² and RMSE to in-sample values from <code>lm()</code></p></li>
<li><p>Note: If using <code>performance</code>, scale predictors in the dataset before modeling (don’t use <code>scale()</code> in the formula)</p></li>
<li><p>i compared the fitted model from dredge and gls with the variables each model selected. The R2 and RMSE from the model selected from full average in dredge is 0.011 and 38 respectively. and the R2 and RMSE from the lm model is 0.28 and 39.835 respectively. using the k fold reduced the error but the performance dropped.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(fit_model_dredge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC   |   BIC |    R2 |   RMSE |  Sigma
---------------------------------------
705.8 | 714.7 | 0.239 | 40.938 | 41.872</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">performance_cv</span>(fit_model_dredge, <span class="at">method =</span> <span class="st">"k_fold"</span>, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">stack =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some of the variables were in matrix-format - probably you used
  `scale()` on your data?
  If so, and you get an error, please try `datawizard::standardize()` to
  standardize your data.
Some of the variables were in matrix-format - probably you used
  `scale()` on your data?
  If so, and you get an error, please try `datawizard::standardize()` to
  standardize your data.
Some of the variables were in matrix-format - probably you used
  `scale()` on your data?
  If so, and you get an error, please try `datawizard::standardize()` to
  standardize your data.
Some of the variables were in matrix-format - probably you used
  `scale()` on your data?
  If so, and you get an error, please try `datawizard::standardize()` to
  standardize your data.
Some of the variables were in matrix-format - probably you used
  `scale()` on your data?
  If so, and you get an error, please try `datawizard::standardize()` to
  standardize your data.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Cross-validation performance (5-fold method)

MSE  | MSE_SE | RMSE | RMSE_SE |    R2 | R2_SE
----------------------------------------------
1716 |   1565 |   38 |      19 | 0.011 |  0.63</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(fit_model_LRT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC   |   BIC |    R2 |   RMSE |  Sigma
---------------------------------------
704.1 | 715.2 | 0.280 | 39.835 | 41.061</code></pre>
</div>
</div></li>
</ol>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>