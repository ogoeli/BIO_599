df <- read.DIF("longnosedace.csv")
df <- read.csv("longnosedace.csv")
lm1 <- lm(longnosedace ~., - stream, data = df)
lm1 <- lm(longnosedace ~. - stream, data = df)
#scale the predictors
df$z_acreage <- scale(df$acreage)
df$z_do2 <- scale(df$do2)
df$z_maxdepth <- scale(df$maxdepth)
df$z_no3 <- scale(df$no3)
df$z_so4 <- scale(df$so4)
df$z_temp <- scale(df$temp)
lm1 <- lm(longnosedace ~. - stream, data = df)
#scale the predictors
df$z_acreage <- scale(df$acreage)
df$z_do2 <- scale(df$do2)
df$z_maxdepth <- scale(df$maxdepth)
df$z_no3 <- scale(df$no3)
df$z_so4 <- scale(df$so4)
df$z_temp <- scale(df$temp)
lm1 <- lm(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp, data = df)
#scale the predictors
df$z_acreage <- scale(df$acreage)
df$z_do2 <- scale(df$do2)
df$z_maxdepth <- scale(df$maxdepth)
df$z_no3 <- scale(df$no3)
df$z_so4 <- scale(df$so4)
df$z_temp <- scale(df$temp)
lm1 <- lm(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp, data = df)
summary(lm1)
#scale the predictors
df$z_acreage <- scale(df$acreage)
df$z_do2 <- scale(df$do2)
df$z_maxdepth <- scale(df$maxdepth)
df$z_no3 <- scale(df$no3)
df$z_so4 <- scale(df$so4)
df$z_temp <- scale(df$temp)
lm1 <- lm(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp, data = df)
summary(lm1)
##fit a gls model to compare the model selection result with.
gls1 <- gls(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp, data = df)
library(tidyverse)
library(nlme)
##fit a gls model to compare the model selection result with.
gls1 <- gls(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp, data = df)
summary(gls1)
##fit a gls model to compare the model selection result with.
gls1 <- gls(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp, data = df)
summary(gls1)
#We add stream as a random intercept to account for species being grouped by stream
lme1 <- lme(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp,
random = ~ 1 | stream,
data = df,
method = "REML")
summary(lme1)
##fit a gls model to compare the model selection result with.
gls1 <- gls(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp, data = df)
summary(gls1)
#We add stream as a random intercept to account for species being grouped by stream
lme1 <- lme(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp,
random = ~ 1 | stream,
data = df,
method = "REML")
summary(lme1)
#Compare models using maximum likelihood to see if adding random effects improves fit.
gls1_ml <- update(gls1, method = "ML")
lme1_ml <- update(lme1, method = "ML")
anova(gls1_ml, lme1_ml)
##fit a gls model to compare the model selection result with.
gls1 <- gls(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp, data = df)
summary(gls1)
#We add stream as a random intercept to account for species being grouped by stream
lme1 <- lme(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp,
random = ~ 1 | stream,
data = df,
method = "REML")
summary(lme1)
#Compare models using maximum likelihood to see if adding random effects improves fit.
gls1_ml <- update(gls1, method = "ML")
lme1_ml <- update(lme1, method = "ML")
anova(gls1_ml, lme1_ml)
##fit a gls model to compare the model selection result with.
gls1 <- gls(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp, data = df)
#summary(gls1)
#We add stream as a random intercept to account for species being grouped by stream
lme1 <- lme(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp,
random = ~ 1 | stream,
data = df,
method = "REML")
#summary(lme1)
#Compare models using maximum likelihood to see if adding random effects improves fit.
gls1_ml <- update(gls1, method = "ML")
lme1_ml <- update(lme1, method = "ML")
#anova(gls1_ml, lme1_ml)
##since addint the random effect doesnt improve the model, we will find the optimal fixed effects from the full model without any random effect
lme1_ml <- update(gls1, method = "ML")
drop1(lme1_ml, test = "Chisq")
step_model <- stepAIC(lme1_ml, direction = "backward")
install.packages(MASS)
install.packages("MASS")
library(tidyverse)
library(nlme)
library(MASS)
step_model <- stepAIC(lme1_ml, direction = "backward")
step_model <- stepAIC(lme1_ml, direction = "backward")
summary(step_model)
#fit the better model
fit_model_StepAIC <-  gls(longnosedace ~ z_acreage +  z_maxdepth + z_no3 , data = df)
summary(fit_model_StepAIC)
library(tidyverse)
library(nlme)
library(MASS)
library(MuMIn)
library(tidyverse)
library(nlme)
library(MASS)
library(MuMIn)
# Generate all subsets of the full ML model
all_models <- dredge(gls1_ml)
# View the top models
all_models
# Average only models within delta < 4
avg_model <- model.avg(all_models, subset = delta < 4)
summary(avg_model)
library(tidyverse)
library(nlme)
library(MASS)
library(MuMIn)
library(performance)
performance(all_models)
set.seed(123)
performance_cv(all_models, method = "k_fold", k = 5, stack = FALSE)
# Average only models within delta < 4
avg_model <- model.avg(all_models, subset = delta < 4)
summary(avg_model)
#fit the better model
fit_model_dredge <-  gls(longnosedace ~ z_acreage +   z_no3 , data = df)
summary(fit_model_dredge)
performance(fit_model_dredge)
set.seed(123)
performance_cv(fit_model_dredge, method = "k_fold", k = 5, stack = FALSE)
##fit a gls model to compare the model selection result with.
gls1 <- gls(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp, data = df)
summary(gls1)
#We add stream as a random intercept to account for species being grouped by stream
lme1 <- lme(longnosedace ~ z_acreage + z_do2 + z_maxdepth + z_no3 + z_so4 + z_temp,
random = ~ 1 | stream,
data = df,
method = "REML")
#summary(lme1)
#Compare models using maximum likelihood to see if adding random effects improves fit.
gls1_ml <- update(gls1, method = "ML")
lme1_ml <- update(lme1, method = "ML")
#anova(gls1_ml, lme1_ml)
##since addint the random effect doesnt improve the model, we will find the optimal fixed effects from the full model without any random effect
lme1_ml <- update(gls1, method = "ML")
drop1(lme1_ml, test = "Chisq")
#fit the better model
fit_model_LRT <-  gls(longnosedace ~ z_acreage +  z_maxdepth + z_no3 , data = df)
summary(fit_model_LRT)
performance(fit_model_dredge)
set.seed(123)
performance_cv(fit_model_dredge, method = "k_fold", k = 5, stack = FALSE)
performance(fit_model_LRT)
# Average only models within delta < 4
avg_model <- model.avg(all_models, subset = delta < 4)
summary(avg_model)
